<!-- 1000 -->

<!-- 2000 -->

<!-- 3000 -->
<!DOCTYPE html>
<!-- 4000 -->
<html lang="en">
<!-- 5000 -->
<head>
<!-- 6000 -->
  <meta charset="utf-8"/>
<!-- 7000 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<!-- 8000 -->
  <title>Measures Dashboard</title>
<!-- 9000 -->
  <style>
/* 10000 */
    body {
/* 11000 */
      font-family: Arial, sans-serif;
/* 12000 */
      margin: 15px;
/* 13000 */
      line-height: 1.4;
/* 14000 */
    }
/* 15000 */
    .container {
/* 16000 */
      max-width: 1000px;
/* 17000 */
      margin: auto;
/* 18000 */
    }
/* 19000 */
    h1 {
/* 20000 */
      margin: 10px 0;
/* 21000 */
      font-size: 22px;
/* 22000 */
    }
/* 23000 */
    /* Plan toggle buttons */
/* 24000 */
    .plan-toggle {
/* 25000 */
      display: flex;
/* 26000 */
      gap: 8px;
/* 27000 */
      margin-bottom: 15px;
/* 28000 */
    }
/* 29000 */
    .plan-button {
/* 30000 */
      padding: 8px 15px;
/* 31000 */
      background-color: #6c757d;
/* 32000 */
      color: white;
/* 33000 */
      border: none;
/* 34000 */
      border-radius: 4px;
/* 35000 */
      cursor: pointer;
/* 36000 */
      font-size: 14px;
/* 37000 */
      transition: all 0.2s;
/* 38000 */
    }
/* 39000 */
    .plan-button.active {
/* 40000 */
      background-color: #28a745;
/* 41000 */
      box-shadow: 0 0 5px rgba(40, 167, 69, 0.6);
/* 42000 */
    }
/* 43000 */
    /* Grid for measure buttons */
/* 44000 */
    .grid-buttons {
/* 45000 */
      display: grid;
/* 46000 */
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
/* 47000 */
      gap: 10px;
/* 48000 */
      margin-bottom: 15px;
/* 49000 */
    }
/* 50000 */
    /* Category headers */
/* 51000 */
    .category-header {
/* 52000 */
      grid-column: 1 / -1;
/* 53000 */
      font-weight: bold;
/* 54000 */
      font-size: 16px;
/* 55000 */
      padding: 5px 0;
/* 56000 */
      border-bottom: 1px solid #ccc;
/* 57000 */
      margin-bottom: 5px;
/* 58000 */
    }
/* 59000 */
    /* Default button (blue for metabolic) */
/* 60000 */
    .button {
/* 61000 */
      background-color: #007bff; /* blue */
/* 62000 */
      color: white;
/* 63000 */
      padding: 12px;
/* 64000 */
      border: none;
/* 65000 */
      border-radius: 4px;
/* 66000 */
      cursor: pointer;
/* 67000 */
      font-size: 14px;
/* 68000 */
      text-align: center;
/* 69000 */
      transition: background-color 0.2s;
/* 70000 */
    }
/* 71000 */
    .button:hover {
/* 72000 */
      background-color: #0056b3;
/* 73000 */
    }
/* 74000 */
    /* Red button (for cancer prevention) */
/* 75000 */
    .red-button {
/* 76000 */
      background-color: #dc3545;
/* 77000 */
      color: white;
/* 78000 */
      padding: 12px;
/* 79000 */
      border: none;
/* 80000 */
      border-radius: 4px;
/* 81000 */
      cursor: pointer;
/* 82000 */
      font-size: 14px;
/* 83000 */
      text-align: center;
/* 84000 */
      transition: background-color 0.2s;
/* 85000 */
    }
/* 86000 */
    .red-button:hover {
/* 87000 */
      background-color: #a71d2a;
/* 88000 */
    }
/* 89000 */
    /* Teal button (for administrative measures) */
/* 90000 */
    .teal-button {
/* 91000 */
      background-color: #20c997;
/* 92000 */
      color: white;
/* 93000 */
      padding: 12px;
/* 94000 */
      border: none;
/* 95000 */
      border-radius: 4px;
/* 96000 */
      cursor: pointer;
/* 97000 */
      font-size: 14px;
/* 98000 */
      text-align: center;
/* 99000 */
      transition: background-color 0.2s;
/* 100000 */
    }
/* 101000 */
    .teal-button:hover {
/* 102000 */
      background-color: #1aa179;
/* 103000 */
    }
/* 104000 */
    /* Small gray button (for other measures) */
/* 105000 */
    .small-button {
/* 106000 */
      background-color: #6c757d; /* gray */
/* 107000 */
      font-size: 13px;
/* 108000 */
      padding: 10px;
/* 109000 */
      color: white;
/* 110000 */
      border: none;
/* 111000 */
      border-radius: 4px;
/* 112000 */
      cursor: pointer;
/* 113000 */
      text-align: center;
/* 114000 */
      transition: background-color 0.2s;
/* 115000 */
    }
/* 116000 */
    .small-button:hover {
/* 117000 */
      background-color: #5a6268;
/* 118000 */
    }
/* 119000 */
    /* Point weight indicators */
/* 120000 */
    .weight-1 {
/* 121000 */
      position: relative;
/* 122000 */
    }
/* 123000 */
    .weight-1::before {
/* 124000 */
      content: "×1";
/* 125000 */
      position: absolute;
/* 126000 */
      top: 5px;
/* 127000 */
      left: 5px;
/* 128000 */
      background-color: rgba(200, 200, 200, 0.8);
/* 129000 */
      color: #000;
/* 130000 */
      font-size: 12px;
/* 131000 */
      padding: 2px 4px;
/* 132000 */
      border-radius: 3px;
/* 133000 */
      font-weight: bold;
/* 134000 */
    }
/* 135000 */
    
/* 136000 */
    .weight-2 {
/* 137000 */
      position: relative;
/* 138000 */
      box-shadow: 0 0 8px 2px rgba(255, 105, 180, 0.6); /* Pink glow */
/* 139000 */
    }
/* 140000 */
    .weight-2::before {
/* 141000 */
      content: "×2";
/* 142000 */
      position: absolute;
/* 143000 */
      top: 5px;
/* 144000 */
      left: 5px;
/* 145000 */
      background-color: rgba(255, 105, 180, 0.8);
/* 146000 */
      color: #fff;
/* 147000 */
      font-size: 12px;
/* 148000 */
      padding: 2px 4px;
/* 149000 */
      border-radius: 3px;
/* 150000 */
      font-weight: bold;
/* 151000 */
    }
/* 152000 */
    
/* 153000 */
    .weight-3 {
/* 154000 */
      position: relative;
/* 155000 */
      box-shadow: 0 0 10px 3px rgba(255, 215, 0, 0.7); /* Golden glow */
/* 156000 */
    }
/* 157000 */
    .weight-3::before {
/* 158000 */
      content: "×3";
/* 159000 */
      position: absolute;
/* 160000 */
      top: 5px;
/* 161000 */
      left: 5px;
/* 162000 */
      background-color: rgba(255, 215, 0, 0.8);
/* 163000 */
      color: #000;
/* 164000 */
      font-size: 12px;
/* 165000 */
      padding: 2px 4px;
/* 166000 */
      border-radius: 3px;
/* 167000 */
      font-weight: bold;
/* 168000 */
    }
/* 169000 */
    
/* 170000 */
    /* Details box */
/* 171000 */
    #details {
/* 172000 */
      border: 1px solid #ccc;
/* 173000 */
      padding: 15px;
/* 174000 */
      border-radius: 4px;
/* 175000 */
      background-color: #f8f9fa;
/* 176000 */
      margin-bottom: 15px;
/* 177000 */
      display: none;
/* 178000 */
      position: relative;
/* 179000 */
    }
/* 180000 */
    #closeDetailsBtn {
/* 181000 */
      position: absolute;
/* 182000 */
      top: 10px;
/* 183000 */
      right: 10px;
/* 184000 */
      background-color: #dc3545;
/* 185000 */
      color: white;
/* 186000 */
      border: none;
/* 187000 */
      padding: 5px 10px;
/* 188000 */
      cursor: pointer;
/* 189000 */
      border-radius: 4px;
/* 190000 */
      font-size: 14px;
/* 191000 */
    }
/* 192000 */
    /* --- MODIFY existing #gapBanner rule --- */
/* 193000 */
#gapBanner {
/* 194000 */
  background-color: #ffe6e6;
/* 195000 */
  /* Make the base text color slightly transparent */
/* 196000 */
  color: rgba(167, 0, 0, 0.75); /* Was 0.75 */
/* 197000 */
  padding: 10px;
/* 198000 */
  border: 1px solid #dc3545;
/* 199000 */
  border-radius: 4px;
/* 200000 */
  margin-bottom: 10px;
/* 201000 */
  font-weight: bold;
/* 202000 */
  /* Ensure other styles you might have here are kept */
/* 203000 */
}
/* 204000 */

/* 205000 */
#gapText strong::before {
/* 206000 */
  content: '[';
/* 207000 */
  color: #d0d00b; /* A distinct yellow */
/* 208000 */
  font-weight: bold; /* Don't inherit bold */
/* 209000 */
  font-size: 1.1em;  /* Slightly smaller than the measure name */
/* 210000 */
  margin-right: 0.2em; /* Space after opening bracket */
/* 211000 */
  /* vertical-align: middle; */ /* Uncomment if vertical alignment is off */
/* 212000 */
}
/* 213000 */

/* 214000 */
#gapText strong::after {
/* 215000 */
  content: ']';
/* 216000 */
  color: #d0d00b; /* A distinct yellow */
/* 217000 */
  font-weight: bold; /* Don't inherit bold */
/* 218000 */
  font-size: 1.1em;  /* Slightly smaller than the measure name */
/* 219000 */
  margin-left: 0.2em; /* Space before closing bracket */
/* 220000 */
  /* vertical-align: middle; */ /* Uncomment if vertical alignment is off */
/* 221000 */
}
/* 222000 */

/* 223000 */
/* Ensure the strong tag itself doesn't have conflicting styles */
/* 224000 */
#gapText strong {
/* 225000 */
  font-size: 1.1em;
/* 226000 */
  color: #c82333;
/* 227000 */
  font-weight: bold;
/* 228000 */
  background-color: transparent;
/* 229000 */
  padding: 0; /* No padding */
/* 230000 */
  border-radius: 0;
/* 231000 */
  opacity: 1;
/* 232000 */
  text-decoration: none;
/* 233000 */
  font-style: normal;
/* 234000 */
  /* NO border-bottom from previous ideas */
/* 235000 */
}
/* 236000 */

/* 237000 */

/* 238000 */
/* --- ADD this new rule for the list inside gapText --- */
/* 239000 */
#gapText ul {
/* 240000 */
    color: #a70000; /* Reset list text color to the original banner red */
/* 241000 */
    /* Optional: Add some space above the list */
/* 242000 */
    margin-top: 5px;
/* 243000 */
}
/* 244000 */
    #weightBanner {
/* 245000 */
      background-color: #fff3cd;
/* 246000 */
      color: #856404;
/* 247000 */
      padding: 10px;
/* 248000 */
      border: 1px solid #ffeeba;
/* 249000 */
      border-radius: 4px;
/* 250000 */
      margin-bottom: 10px;
/* 251000 */
      font-weight: bold;
/* 252000 */
    }
/* 253000 */
    
/* 254000 */
    /* Unified button styling for the details section buttons */
/* 255000 */
    .details-buttons {
/* 256000 */
      display: flex;
/* 257000 */
      flex-wrap: wrap;
/* 258000 */
      gap: 8px;
/* 259000 */
      margin: 12px 0;
/* 260000 */
      justify-content: flex-start;
/* 261000 */
    }
/* 262000 */

/* 263000 */
    .details-buttons button {
/* 264000 */
      flex: 1;
/* 265000 */
      min-width: 90px;
/* 266000 */
      background-color: #6c757d;
/* 267000 */
      color: white;
/* 268000 */
      padding: 8px 5px;
/* 269000 */
      border: none;
/* 270000 */
      border-radius: 4px;
/* 271000 */
      cursor: pointer;
/* 272000 */
      font-size: 12px;
/* 273000 */
      text-align: center;
/* 274000 */
      transition: background-color 0.2s;
/* 275000 */
      white-space: nowrap;
/* 276000 */
      overflow: hidden;
/* 277000 */
      text-overflow: ellipsis;
/* 278000 */
    }
/* 279000 */

/* 280000 */
    .details-buttons button:hover {
/* 281000 */
      background-color: #5a6268;
/* 282000 */
    }
/* 283000 */

/* 284000 */
    .details-buttons button.active {
/* 285000 */
      background-color: #495057;
/* 286000 */
      box-shadow: 0 0 4px rgba(0,0,0,0.3);
/* 287000 */
    }
/* 288000 */

/* 289000 */
    /* Responsive adjustments for very small screens */
/* 290000 */
    @media (max-width: 350px) {
/* 291000 */
      .details-buttons {
/* 292000 */
        flex-direction: column;
/* 293000 */
      }
/* 294000 */
      
/* 295000 */
      .details-buttons button {
/* 296000 */
        width: 100%;
/* 297000 */
      }
/* 298000 */
    }
/* 299000 */
    
/* 300000 */
    #extraDetails {
/* 301000 */
      display: none;
/* 302000 */
      margin-top: 10px;
/* 303000 */
      padding: 10px;
/* 304000 */
      border: 1px solid #ddd;
/* 305000 */
      background-color: #e9ecef;
/* 306000 */
      border-radius: 4px;
/* 307000 */
    }
/* 308000 */
    
/* 309000 */
    #starRatingsDetails, #bonusTiersDetails {
/* 310000 */
      display: none;
/* 311000 */
      margin-top: 10px; 
/* 312000 */
      padding: 10px;
/* 313000 */
      border: 1px solid #ddd;
/* 314000 */
      background-color: #e9ecef;
/* 315000 */
      border-radius: 4px;
/* 316000 */
    }
/* 317000 */
    
/* 318000 */
    .summary-stats {
/* 319000 */
      display: flex;
/* 320000 */
      gap: 15px;
/* 321000 */
      margin-bottom: 15px;
/* 322000 */
      font-size: 14px;
/* 323000 */
    }
/* 324000 */
    .stat {
/* 325000 */
      background-color: #f0f0f0;
/* 326000 */
      padding: 8px 12px;
/* 327000 */
      border-radius: 4px;
/* 328000 */
      font-weight: bold;
/* 329000 */
    }
/* 330000 */
    /* Ask AI Section styling */
/* 331000 */
    #askAISection {
/* 332000 */
      border: 1px solid #ccc;
/* 333000 */
      padding: 15px;
/* 334000 */
      border-radius: 4px;
/* 335000 */
      background-color: #f0f0f0;
/* 336000 */
      margin-top: 30px;
/* 337000 */
      text-align: center;
/* 338000 */
    }
/* 339000 */
    #exhaustiveQuery {
/* 340000 */
      width: 100%;
/* 341000 */
      height: 80px;
/* 342000 */
      margin-top: 10px;
/* 343000 */
      display: none;
/* 344000 */
    }
/* 345000 */
    #copyQueryBtn {
/* 346000 */
      background-color: #28a745;
/* 347000 */
      color: white;
/* 348000 */
      padding: 10px;
/* 349000 */
      border: none;
/* 350000 */
      border-radius: 4px;
/* 351000 */
      cursor: pointer;
/* 352000 */
      font-size: 16px;
/* 353000 */
      margin-top: 10px;
/* 354000 */
      display: none;
/* 355000 */
    }
/* 356000 */
    .link-buttons a {
/* 357000 */
      display: inline-block;
/* 358000 */
      margin: 5px;
/* 359000 */
      padding: 8px 12px;
/* 360000 */
      background-color: #007bff;
/* 361000 */
      color: white;
/* 362000 */
      text-decoration: none;
/* 363000 */
      border-radius: 4px;
/* 364000 */
    }
/* 365000 */
    .link-buttons a:hover {
/* 366000 */
      background-color: #0056b3;
/* 367000 */
    }
/* 368000 */
    
/* 369000 */
    /* Focus Measures Section Styling */
/* 370000 */
    .focus-measures-section {
/* 371000 */
      margin-bottom: 25px;
/* 372000 */
      border: 1px solid #e0e0e0;
/* 373000 */
      border-radius: 6px;
/* 374000 */
      padding: 12px;
/* 375000 */
      background-color: #f9f9f9;
/* 376000 */
    }
/* 377000 */

/* 378000 */
    .focus-measures-section h3 {
/* 379000 */
      margin-top: 0;
/* 380000 */
      margin-bottom: 15px;
/* 381000 */
      font-size: 18px;
/* 382000 */
      color: #333;
/* 383000 */
    }
/* 384000 */

/* 385000 */
    .focus-buttons-container {
/* 386000 */
      display: flex;
/* 387000 */
      flex-wrap: wrap;
/* 388000 */
      gap: 8px;
/* 389000 */
    }
/* 390000 */

/* 391000 */
    /* Focus measure buttons - base shared styles */
/* 392000 */
    .focus-metabolic, .focus-cancer, .focus-administrative, .focus-other {
/* 393000 */
      color: white;
/* 394000 */
      font-size: 12px;
/* 395000 */
      padding: 8px 10px;
/* 396000 */
      border: none;
/* 397000 */
      border-radius: 4px;
/* 398000 */
      cursor: pointer;
/* 399000 */
      transition: background-color 0.2s;
/* 400000 */
      width: 130px;
/* 401000 */
      white-space: nowrap;
/* 402000 */
      overflow: hidden;
/* 403000 */
      text-overflow: ellipsis;
/* 404000 */
      text-align: center;
/* 405000 */
    }
/* 406000 */

/* 407000 */
    /* Specific category colors */
/* 408000 */
    .focus-metabolic {
/* 409000 */
      background-color: #007bff; /* Blue for metabolic */
/* 410000 */
    }
/* 411000 */
    .focus-metabolic:hover {
/* 412000 */
      background-color: #0056b3;
/* 413000 */
    }
/* 414000 */

/* 415000 */
    .focus-cancer {
/* 416000 */
      background-color: #dc3545; /* Red for cancer */
/* 417000 */
    }
/* 418000 */
    .focus-cancer:hover {
/* 419000 */
      background-color: #a71d2a;
/* 420000 */
    }
/* 421000 */

/* 422000 */
    .focus-administrative {
/* 423000 */
      background-color: #20c997; /* Teal for administrative */
/* 424000 */
    }
/* 425000 */
    .focus-administrative:hover {
/* 426000 */
      background-color: #1aa179;
/* 427000 */
    }
/* 428000 */

/* 429000 */
    .focus-other {
/* 430000 */
      background-color: #6c757d; /* Gray for other */
/* 431000 */
    }
/* 432000 */
    .focus-other:hover {
/* 433000 */
      background-color: #5a6268;
/* 434000 */
    }
/* 435000 */

/* 436000 */
    /* Responsive adjustments for mobile */
/* 437000 */
    @media (max-width: 768px) {
/* 438000 */
      .focus-buttons-container {
/* 439000 */
        display: grid;
/* 440000 */
        grid-template-columns: repeat(2, 1fr); /* 2 buttons per row on mobile */
/* 441000 */
        gap: 8px;
/* 442000 */
      }
/* 443000 */
      
/* 444000 */
      .focus-metabolic, .focus-cancer, .focus-administrative, .focus-other {
/* 445000 */
        width: 100%;  /* Full width within their grid cell */
/* 446000 */
      }
/* 447000 */
    }
/* 448000 */

/* 449000 */
    /* Active state for all buttons */
/* 450000 */
    .button.active-measure, 
/* 451000 */
    .red-button.active-measure, 
/* 452000 */
    .teal-button.active-measure, 
/* 453000 */
    .small-button.active-measure {
/* 454000 */
      outline: 3px solid #333;
/* 455000 */
      box-shadow: 0 0 0 1px white inset;
/* 456000 */
      position: relative;
/* 457000 */
    }
/* 458000 */

/* 459000 */
    .focus-metabolic.active-measure, 
/* 460000 */
    .focus-cancer.active-measure, 
/* 461000 */
    .focus-administrative.active-measure, 
/* 462000 */
    .focus-other.active-measure {
/* 463000 */
      outline: 3px solid #333;
/* 464000 */
      box-shadow: 0 0 0 1px white inset;
/* 465000 */
      position: relative;
/* 466000 */
    }
/* 467000 */

/* 468000 */
    /* Add a checkmark to active buttons */
/* 469000 */
    .active-measure::after {
/* 470000 */
      content: "✓";
/* 471000 */
      position: absolute;
/* 472000 */
      bottom: 3px;
/* 473000 */
      right: 5px;
/* 474000 */
      font-weight: bold;
/* 475000 */
      font-size: 12px;
/* 476000 */
    }
/* 477000 */

/* 478000 */
    /* Exclusions Button */
/* 479000 */
.exclusions-button {
/* 480000 */
  background-color: #dc3545;
/* 481000 */
  color: white;
/* 482000 */
  padding: 8px 12px;
/* 483000 */
  border: none;
/* 484000 */
  border-radius: 4px;
/* 485000 */
  cursor: pointer;
/* 486000 */
  font-size: 14px;
/* 487000 */
  margin-top: 5px;
/* 488000 */
  margin-bottom: 10px;
/* 489000 */
  display: block;
/* 490000 */
}
/* 491000 */

/* 492000 */
.exclusions-button:hover {
/* 493000 */
  background-color: #c82333;
/* 494000 */
}
/* 495000 */

/* 496000 */
/* Exclusions Dropdown */
/* 497000 */
#exclusionsDropdown {
/* 498000 */
  display: none;
/* 499000 */
  padding: 12px;
/* 500000 */
  background-color: #f8f9fa;
/* 501000 */  border: 3px solid #dc3545; /* Thick red border */
/* 502000 */
  border-radius: 4px;
/* 503000 */
  margin-bottom: 15px;
/* 504000 */
}
/* 505000 */

/* 506000 */
.exclusion-item {
/* 507000 */
  margin-bottom: 8px;
/* 508000 */
  padding-left: 15px;
/* 509000 */
  position: relative;
/* 510000 */
}
/* 511000 */

/* 512000 */
.exclusion-item:before {
/* 513000 */
  content: "•";
/* 514000 */
  position: absolute;
/* 515000 */
  left: 0;
/* 516000 */
  color: #dc3545;
/* 517000 */
}
/* 518000 */

/* 519000 */
.frailty-item {
/* 520000 */
  color: #dc3545;
/* 521000 */
  font-weight: bold;
/* 522000 */
}
/* 523000 */

/* 524000 */

<!-- 525000 -->
</style>
<!-- 526000 -->
</head>
<!-- 527000 -->
<body>
<!-- 528000 -->
  <div class="container">
<!-- 529000 -->
    <div style="display: flex; align-items: center; margin-bottom: 15px;">
<!-- 530000 -->
      <h2 style="margin: 0; margin-right: 15px;">Measures 2025</h2>
<!-- 531000 -->
    </div>
<!-- 532000 -->
    
<!-- 533000 -->
    <h5 class="disclaimer"><small>Below experimental view / possible errors, please <a href="https://upmchs-my.sharepoint.com/:b:/g/personal/sohnae_upmc_edu/ETaVvG0aWDlEtBOeYg9N0OQBXrH79wwiXb_HmyIAqd2h-g?e=fDijHn" target="_blank">vet with source</a></small></h5>
<!-- 534000 -->
    
<!-- 535000 -->
<!-- Plan Toggle Buttons -->
<!-- 536000 -->
<div class="plan-toggle">
<!-- 537000 -->
  <button id="medicare-btn" class="plan-button active">UPMC for Life (Medicare/SNP)</button>
<!-- 538000 -->
  <button id="commercial-btn" class="plan-button">Commercial</button>
<!-- 539000 -->
  <button id="medicaid-btn" class="plan-button">UPMC for You (Medicaid)</button>
<!-- 540000 -->
</div>
<!-- 541000 -->
    
<!-- 542000 -->
    <!-- Summary Stats -->
<!-- 543000 -->
    <div class="summary-stats" style="display: none;">
<!-- 544000 -->
      <div class="stat">Measures: <span id="measure-count">0</span></div>
<!-- 545000 -->
      <div class="stat">Points: <span id="point-count">0</span></div>
<!-- 546000 -->
    </div>
<!-- 547000 -->

<!-- 548000 -->
    <div id="details">
<!-- 549000 -->
      <button id="closeDetailsBtn">Close</button>
<!-- 550000 -->
      <div id="gapBanner">Gap: <span id="gapText">[Gap info]</span></div>
<!-- 551000 -->
      <button id="exclusionsBtn" class="exclusions-button">Exclusions ▼</button>
<!-- 552000 -->
      <div id="exclusionsDropdown"></div>
<!-- 553000 -->
      <div id="weightBanner">Weight: <span id="weightText">[Weight info]</span></div>
<!-- 554000 -->
      <div id="guidelineDetails">
<!-- 555000 -->
        <ul>
<!-- 556000 -->
          <li>Please select a measure.</li>
<!-- 557000 -->
        </ul>
<!-- 558000 -->
      </div>
<!-- 559000 -->
      <div class="details-buttons">
<!-- 560000 -->
        <button id="toggleExtraBtn">Best Practices</button>
<!-- 561000 -->
        <button id="toggleStarRatingsBtn">Show Star Ratings</button>
<!-- 562000 -->
        <button id="toggleBonusTiersBtn" style="display: none;">Show Bonus Tiers</button>
<!-- 563000 -->
      </div>
<!-- 564000 -->
      <div id="extraDetails">
<!-- 565000 -->
        <ul>
<!-- 566000 -->
          <li>[Extra details here]</li>
<!-- 567000 -->
        </ul>
<!-- 568000 -->
      </div>
<!-- 569000 -->
      <div id="starRatingsDetails">
<!-- 570000 -->
        <h4>Star Ratings Thresholds</h4>
<!-- 571000 -->
        <div id="starRatingsContent">
<!-- 572000 -->
          <p>Select a measure to see star ratings.</p>
<!-- 573000 -->
        </div>
<!-- 574000 -->
      </div>
<!-- 575000 -->
      <div id="bonusTiersDetails">
<!-- 576000 -->
        <h4>Bonus Tier Thresholds</h4>
<!-- 577000 -->
        <div id="bonusTiersContent">
<!-- 578000 -->
          <p>Select a bonus measure to see tier thresholds.</p>
<!-- 579000 -->
        </div>
<!-- 580000 -->
      </div>
<!-- 581000 -->
    </div>
<!-- 582000 -->

<!-- 583000 -->
    <!-- Buttons for measures -->
<!-- 584000 -->
    <div class="grid-buttons" id="allMeasuresButtons"></div>
<!-- 585000 -->
    
<!-- 586000 -->
    <!-- Focus Measures Section (Bonus Measures) moved here -->
<!-- 587000 -->
    <div class="focus-measures-section">
<!-- 588000 -->
      <h3>Bonus Measures</h3>
<!-- 589000 -->
      <div class="focus-buttons-container" id="focusMeasuresButtons"></div>
<!-- 590000 -->
    </div>
<!-- 591000 -->
    
<!-- 592000 -->
    <!-- Ask AI Section -->
<!-- 593000 -->
    <div id="askAISection">
<!-- 594000 -->
      <h3>Ask AI for Exclusion Diagnosis Codes</h3>
<!-- 595000 -->
      <p>This will compile the current guideline information into a prompt for you to copy and paste into your AI search bar.</p>
<!-- 596000 -->
      <button id="askAIBtn" class="small-button">Generate AI Prompt</button>
<!-- 597000 -->
      <textarea id="exhaustiveQuery" placeholder="Exclusion diagnosis prompt will appear here..." style="display:none;"></textarea>
<!-- 598000 -->
      <button id="copyQueryBtn" style="display:none;">Copy Prompt</button>
<!-- 599000 -->
      <div class="link-buttons">
<!-- 600000 -->
        <a href="https://www.openevidence.com/" target="_blank">Open Evidence</a>
<!-- 601000 -->
        <a href="https://www.perplexity.ai" target="_blank">Perplexity</a>
<!-- 602000 -->
        <a href="https://chat.openai.com" target="_blank">ChatGPT</a>
<!-- 603000 -->
        <a href="https://gemini.google.com" target="_blank">Gemini</a>
<!-- 604000 -->
        <a href="https://www.deepseek.ai" target="_blank">DeepSeek</a>
<!-- 605000 -->
      </div>
<!-- 606000 -->
    </div>
<!-- 607000 -->
  </div>
<!-- 608000 -->

  <script>
 // Global variables
let medicalData = {};
let currentPlan = "commercial";
let currentGuideline = null;
let starRatingsData = {};
let bonusMeasuresData = {};
// Define focused measures for each plan
const focusedMeasures = {
  "commercial": ["BCS-E", "CCS-E", "CHL", "GSD", "UCU"],
  "medicaid": ["BCS-E", "CCS-E", "CHL", "GSD", "UCU"],
  "medicare": ["FMC", "DMA", "PCR", "TRC-FU", "UCU"]
};
// Measure point values by plan
const planData = {
  "commercial": {
    measurePoints: {
      "AIS-E": 1,
      "URI": 2,
      "AMR": 1,
      "BCS-E": 3,
      "CCS-E": 2,
      "CHL": 1,
      "COL-E": 1,
      "EED": 1,
      "GSD": 2,
      "CBP": 2,
      "KED": 1,
      "PCE": 1,
      "PCR": 3,
      "SPC": 2,
      "SPD": 2
    }
  },
  "medicaid": {
    measurePoints: {
      "AIS-E": 1,
      "URI": 1,
      "AMR": 3,
      "BCS-E": 3,
      "CCS-E": 2,
      "CHL": 2,
      "COL-E": 1,
      "EED": 1,
      "GSD": 3,
      "CBP": 2,
      "KED": 1,
      "PCE": 1,
      "PCR": 2,
      "SPC": 1,
      "SPD": 1
    }
  },
  "medicare": {
    measurePoints: {
      "BCS-E": 1,
      "COL-E": 1,
      "EED": 1,
      "GSD-Medicare": 3,
      "COB": 1,
      "CBP": 3,
      "FMC": 1,
      "KED": 1,
      "CMA": 3,
      "DMA": 3,
      "HMA": 3,
      "TRC": 1,
      "TRC-ENG": 1,
      "PCR": 3,
      "POLY-ACH": 1,
      "SPC": 1,
      "SUPD": 1,
      "TRC-FU": 1
    }
  }
};
// Category definitions
const categories = {
  metabolic: [
    { displayName: "BP Control", measureId: "CBP" },
    { displayName: "BP Med Adherence", measureId: "HMA" },
    { displayName: "DM Glycemic Control", measureId: "GSD" },
    { displayName: "DM Glycemic Control", measureId: "GSD-Medicare" },
    { displayName: "DM Med Adherence", measureId: "DMA" },
    { displayName: "Statin Adherence", measureId: "CMA" },
    { displayName: "DM Eye Exam", measureId: "EED" },
    { displayName: "DM Kidney Evaluation", measureId: "KED" },
    { displayName: "DM Statin Use", measureId: "SUPD" },
    { displayName: "CV Statin Therapy", measureId: "SPC" },
    { displayName: "DM Statin Therapy", measureId: "SPD" }
  ],
  cancer: [
    { displayName: "Breast Cancer Screen", measureId: "BCS-E" },
    { displayName: "Colorectal Screen", measureId: "COL-E" },
    { displayName: "Cervical Cancer Screen", measureId: "CCS-E" }
  ],
  administrative: [
    { displayName: "Readmission Prevention", measureId: "PCR" },
    { displayName: "ED Follow-Up Care", measureId: "FMC" },
    { displayName: "Discharge Med Reconciliation", measureId: "TRC", type: "Reconciliation" },
    { displayName: "Post-Discharge Engagement", measureId: "TRC-ENG", type: "Engagement" },
    { displayName: "7-Day Inpatient Follow-Up", measureId: "TRC-FU" },
    { displayName: "Unplanned Care Utilization", measureId: "UCU" }
  ],
  other: [
    { displayName: "URI Treatment", measureId: "URI" },
    { displayName: "Asthma Medication", measureId: "AMR" },
    { displayName: "Bronchitis Treatment", measureId: "AAB" },
    { displayName: "COPD Management", measureId: "PCE" },
    { displayName: "Flu Immunization", measureId: "AIS-E" },
    { displayName: "Opioid-Benzo Use", measureId: "COB" },
    { displayName: "Anticholinergic Polypharmacy", measureId: "POLY-ACH" },
    { displayName: "Chlamydia Screen", measureId: "CHL" }
  ]
};
// Function to clear active button state
function clearActiveButtonState() {
  // Clear active state from all buttons
  document.querySelectorAll('.active-measure').forEach(btn => {
    btn.classList.remove('active-measure');
  });
}
// Function to load star ratings JSON
function loadStarRatings() {
  fetch('stars.json')
    .then(response => {
      if (!response.ok) throw new Error("Error loading Star Ratings JSON: " + response.statusText);
      return response.json();
    })
    .then(data => {
      starRatingsData = data;
      console.log("Loaded star ratings data:", starRatingsData);
    })
    .catch(error => {
      console.error("Error loading star ratings data:", error);
    });
}
// Function to load bonus measures JSON
function loadBonusMeasures() {
  fetch('bonus.json')
    .then(response => {
      if (!response.ok) throw new Error("Error loading Bonus Measures JSON: " + response.statusText);
      return response.json();
    })
    .then(data => {
      bonusMeasuresData = data;
      console.log("Loaded bonus measures data:", bonusMeasuresData);
    })
    .catch(error => {
      console.error("Error loading bonus measures data:", error);
    });
}
// Convert plan name to service line key used in the star ratings JSON
function getPlanServiceLineKey(planName) {
  switch(planName) {
    case "commercial": return "commercial";
    case "medicaid": return "medicaid";
    case "medicare": return "medicare";
    default: return "";
  }
}
// Function to check if a measure is a bonus measure for the current plan
function isBonusMeasure(measureId) {
  return focusedMeasures[currentPlan] && focusedMeasures[currentPlan].includes(measureId);
}
// Display star ratings for the current measure and plan
function displayStarRatings(measureId) {
  const starRatingsContent = document.getElementById("starRatingsContent");
  const serviceLineKey = getPlanServiceLineKey(currentPlan);
  console.log("Displaying star ratings for:", measureId, "in", serviceLineKey);
  try {
    // Check if we have data and the measure exists
    if (!starRatingsData ||
        !starRatingsData.healthcare_quality_measures ||
        !starRatingsData.healthcare_quality_measures[measureId] ||
        !starRatingsData.healthcare_quality_measures[measureId].service_lines ||
        !starRatingsData.healthcare_quality_measures[measureId].service_lines[serviceLineKey]) {
      starRatingsContent.innerHTML = `<p>No star ratings data available for ${measureId} in the current plan.</p>`;
      return;
    }
    // Get the star ratings data for this measure and service line
    const measureData = starRatingsData.healthcare_quality_measures[measureId];
    const serviceLineData = measureData.service_lines[serviceLineKey];
    // Check if star thresholds exist
    if (!serviceLineData.star_thresholds) {
      starRatingsContent.innerHTML = `<p>No star ratings thresholds available for ${measureId}.</p>`;
      return;
    }
    // Format the data as a table
    let html = `
      <p><strong>${measureData.measure_name}</strong></p>
      <p>Weight: ${serviceLineData.weight}</p>
      <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
        <tr style="background-color: #f0f0f0; font-weight: bold;">
          <td style="padding: 8px; border: 1px solid #ddd;">Star Rating</td>
          <td style="padding: 8px; border: 1px solid #ddd;">Threshold</td>
        </tr>`;
    // Add rows for each star threshold
    if (serviceLineData.star_thresholds["5_stars"]) {
      html += `
        <tr>
          <td style="padding: 8px; border: 1px solid #ddd;">⭐⭐⭐⭐⭐ (5 Stars)</td>
          <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.star_thresholds["5_stars"] * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
        </tr>`;
    }
    if (serviceLineData.star_thresholds["4_stars"]) {
      html += `
        <tr>
          <td style="padding: 8px; border: 1px solid #ddd;">⭐⭐⭐⭐ (4 Stars)</td>
          <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.star_thresholds["4_stars"] * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
        </tr>`;
    }
    if (serviceLineData.star_thresholds["3_stars"]) {
      html += `
        <tr>
          <td style="padding: 8px; border: 1px solid #ddd;">⭐⭐⭐ (3 Stars)</td>
          <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.star_thresholds["3_stars"] * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
        </tr>`;
    }
    if (serviceLineData.star_thresholds["2_stars"]) {
      html += `
        <tr>
          <td style="padding: 8px; border: 1px solid #ddd;">⭐⭐ (2 Stars)</td>
          <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.star_thresholds["2_stars"] * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
        </tr>`;
    }
    html += `</table>`;
    // Add note for PCR measure which is inversed
    if (measureId === "PCR") {
      html += `<p style="margin-top: 10px; font-style: italic; color: #dc3545;">Note: Lower scores are better for this measure.</p>`;
    }
    starRatingsContent.innerHTML = html;
  } catch (error) {
    console.error("Error displaying star ratings:", error);
    starRatingsContent.innerHTML = `<p>Error displaying star ratings: ${error.message}</p>`;
  }
}
// Display bonus tiers for the current measure and plan
function displayBonusTiers(measureId) {
  const bonusTiersContent = document.getElementById("bonusTiersContent");
  const serviceLineKey = getPlanServiceLineKey(currentPlan);
  console.log("Displaying bonus tiers for:", measureId, "in", serviceLineKey);
  // Debug data availability
  console.log("Bonus measures data available:", !!bonusMeasuresData);
  console.log("Bonus measures available:", bonusMeasuresData && !!bonusMeasuresData.bonus_measures);
  // Check if we have data and the measure exists
  if (!bonusMeasuresData.bonus_measures ||
      !bonusMeasuresData.bonus_measures[measureId] ||
      !bonusMeasuresData.bonus_measures[measureId].service_lines ||
      !bonusMeasuresData.bonus_measures[measureId].service_lines[serviceLineKey]) {
    bonusTiersContent.innerHTML = `<p>No bonus tier data available for ${measureId} in the current plan.</p>`;
    return;
  }
  // Get the bonus tier data for this measure and service line
  const measureData = bonusMeasuresData.bonus_measures[measureId];
  const serviceLineData = measureData.service_lines[serviceLineKey];
  // Format the data as a table
// In the displayBonusTiers function
// Format the data as a table
let html = `
  <p><strong>${measureData.measure_name}</strong></p>
  <p>${serviceLineData.description}</p>
  <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
    <tr style="background-color: #f0f0f0; font-weight: bold;">
      <td style="padding: 8px; border: 1px solid #ddd;">Tier</td>
      <td style="padding: 8px; border: 1px solid #ddd;">Threshold</td>
      <td style="padding: 8px; border: 1px solid #ddd;">Bonus Weight</td>
    </tr>
    <tr>
      <td style="padding: 8px; border: 1px solid #ddd;">Tier 3</td>
      <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.tiers.tier_3.threshold * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
      <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">${serviceLineData.tiers.tier_3.points}</td>
    </tr>
    <tr>
      <td style="padding: 8px; border: 1px solid #ddd;">Tier 2</td>
      <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.tiers.tier_2.threshold * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
      <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">${serviceLineData.tiers.tier_2.points}</td>
    </tr>
    <tr>
      <td style="padding: 8px; border: 1px solid #ddd;">Tier 1</td>
      <td style="padding: 8px; border: 1px solid #ddd;">${(serviceLineData.tiers.tier_1.threshold * 100).toFixed(1)}%${measureId === 'PCR' ? ' or below' : ' or above'}</td>
      <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">${serviceLineData.tiers.tier_1.points}</td>
    </tr>
  </table>`;
  // Add note for PCR measure which is inversed
  if (measureId === "PCR" && serviceLineData.note) {
    html += `<p style="margin-top: 10px; font-style: italic; color: #dc3545;">Note: ${serviceLineData.note}</p>`;
  }
  bonusTiersContent.innerHTML = html;
}
function generateFocusMeasures(planName) {
  const container = document.getElementById("focusMeasuresButtons");
  container.innerHTML = "";
  const plan = planData[planName];
  if (!plan) return;
  // Get measure points for this plan
  const measurePoints = plan.measurePoints || {};
  // Get the focus measures for this plan
  const focusedMeasureIds = focusedMeasures[planName] || [];
  // Find category for a measure ID
  function findCategory(measureId) {
    for (const category in categories) {
      const found = categories[category].find(m => m.measureId === measureId);
      if (found) return category;
    }
    return "other"; // Default
  }
  // Find display name for a measure ID
  function findDisplayName(measureId) {
    for (const category in categories) {
      const found = categories[category].find(m => m.measureId === measureId);
      if (found) return found.displayName;
    }
    return measureId; // Default
  }
  function createFocusButton(measureId, category) {
    const displayName = findDisplayName(measureId);
    // Special handling for UCU which isn't in measurePoints
    const points = measureId === "UCU" ? 3 : (measurePoints[measureId] || 1);
    const btn = document.createElement("button");
    btn.textContent = displayName;
    btn.setAttribute("data-measure", measureId);
    btn.setAttribute("data-points", points);
    // Apply category-specific class
    btn.className = `focus-${category}`;
    btn.addEventListener("click", function() {
      displayGuideline(
        measureId,
        null,
        null,
        points
      );
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    container.appendChild(btn);
  }
  // Process measures in category order
  // First, gather all focus measures by category
  const categorizedMeasures = {
    metabolic: [],
    cancer: [],
    administrative: [],
    other: []
  };
  // Categorize all focus measures
  focusedMeasureIds.forEach(measureId => {
    // Special handling for UCU which isn't in measurePoints
    if (measurePoints.hasOwnProperty(measureId) || measureId === "UCU") {
      const category = findCategory(measureId);
      categorizedMeasures[category].push(measureId);
    }
  });
  // Now create buttons in category order
  categorizedMeasures.metabolic.forEach(measureId => {
    createFocusButton(measureId, "metabolic");
  });
  categorizedMeasures.cancer.forEach(measureId => {
    createFocusButton(measureId, "cancer");
  });
  categorizedMeasures.administrative.forEach(measureId => {
    createFocusButton(measureId, "administrative");
  });
  categorizedMeasures.other.forEach(measureId => {
    createFocusButton(measureId, "other");
  });
}
// Generate buttons for the current plan
function generateButtons(planName) {
  const container = document.getElementById("allMeasuresButtons");
  container.innerHTML = "";
  const plan = planData[planName];
  if (!plan) return;
  // Get measure points for this plan
  const measurePoints = plan.measurePoints || {};
  // Only show measures that exist in this plan
  function shouldShowMeasure(measureId) {
    return measurePoints.hasOwnProperty(measureId);
  }
  // Create header for a category
  function createHeader(text) {
    const header = document.createElement("div");
    header.className = "category-header";
    header.textContent = text;
    container.appendChild(header);
  }
  // Create button for a measure
  function createButton(measure, className) {
    if (!shouldShowMeasure(measure.measureId)) return;
    const points = measurePoints[measure.measureId] || 1;
    const btn = document.createElement("button");
    btn.textContent = measure.displayName;
    btn.setAttribute("data-measure", measure.measureId);
    btn.setAttribute("data-points", points);
    // If type is provided (for TRC), attach it
    if (measure.type) {
      btn.setAttribute("data-type", measure.type);
    }
    // Apply base class
    btn.className = className;
    // Add weight-specific class
    btn.classList.add(`weight-${points}`);
    btn.addEventListener("click", function() {
      displayGuideline(
        measure.measureId,
        null,
        this.getAttribute("data-type"),
        points
      );
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    container.appendChild(btn);
  }
  // Create buttons for a category, sorted by weight (3, 2, 1)
  function createCategoryButtons(categoryMeasures, className) {
    // First show high-weight measures (×3)
    categoryMeasures.forEach(measure => {
      if (shouldShowMeasure(measure.measureId) && measurePoints[measure.measureId] === 3) {
        createButton(measure, className);
      }
    });
    // Then show medium-weight measures (×2)
    categoryMeasures.forEach(measure => {
      if (shouldShowMeasure(measure.measureId) && measurePoints[measure.measureId] === 2) {
        createButton(measure, className);
      }
    });
    // Finally show low-weight measures (×1)
    categoryMeasures.forEach(measure => {
      if (shouldShowMeasure(measure.measureId) && measurePoints[measure.measureId] === 1) {
        createButton(measure, className);
      }
    });
  }
  // Generate buttons by category
  // Metabolic measures
  let hasMetabolicMeasures = categories.metabolic.some(m => shouldShowMeasure(m.measureId));
  if (hasMetabolicMeasures) {
    createHeader("Metabolic/Cardiometabolic Measures");
    createCategoryButtons(categories.metabolic, "button");
  }
  // Cancer measures
  let hasCancerMeasures = categories.cancer.some(m => shouldShowMeasure(m.measureId));
  if (hasCancerMeasures) {
    createHeader("Cancer Prevention");
    createCategoryButtons(categories.cancer, "red-button");
  }
  // Administrative measures
  let hasAdminMeasures = categories.administrative.some(m => shouldShowMeasure(m.measureId));
  if (hasAdminMeasures) {
    createHeader("Administrative");
    createCategoryButtons(categories.administrative, "teal-button");
  }
  // Other measures
  let hasOtherMeasures = categories.other.some(m => shouldShowMeasure(m.measureId));
  if (hasOtherMeasures) {
    createHeader("Other Measures");
    createCategoryButtons(categories.other, "small-button");
  }
  // Update summary statistics
  updateSummaryStats(planName);
}
// Update summary statistics
function updateSummaryStats(planName) {
  const plan = planData[planName];
  if (!plan) return;
  const measurePoints = plan.measurePoints || {};
  const measures = Object.keys(measurePoints);
  const totalMeasures = measures.length;
  // Calculate total points by summing up all point values
  let totalPoints = 0;
  measures.forEach(measure => {
    totalPoints += measurePoints[measure];
  });
  document.getElementById("measure-count").textContent = totalMeasures;
  document.getElementById("point-count").textContent = totalPoints;
}
// Switch to a different plan
function switchPlan(planName) {
  if (!planData[planName]) return;
  // Update active button
  document.querySelectorAll(".plan-button").forEach(btn => {
    btn.classList.remove("active");
  });
  document.getElementById(`${planName}-btn`).classList.add("active");
  // Hide details panel
  document.getElementById("details").style.display = "none";
  // Update current plan
  currentPlan = planName;
  // Generate focus measure buttons
  generateFocusMeasures(planName);
  // Generate all measure buttons
  generateButtons(planName);
}
// Function to populate exclusions dropdown
function populateExclusions(guideline) {
  // Reset exclusions dropdown
  const dropdown = document.getElementById("exclusionsDropdown");
  dropdown.style.display = "none";
  const exclusionsBtn = document.getElementById("exclusionsBtn");
  exclusionsBtn.textContent = "Exclusions ▼";
  // Generate exclusions content
  let exclusionsHtml = "";
  let frailtyFound = false;
  if (guideline.denominator_exclusions && guideline.denominator_exclusions.length > 0) {
    // Build exclusions list
    exclusionsHtml += "<div>";
    for (let i = 0; i < guideline.denominator_exclusions.length; i++) {
      const exclusion = guideline.denominator_exclusions[i];
      const exclusionLower = exclusion.toLowerCase();
      // Check for frailty or advanced illness
      if (exclusionLower.includes("frailty") || exclusionLower.includes("advanced illness")) {
        frailtyFound = true;
        exclusionsHtml += `<div class="exclusion-item frailty-item">${exclusion}</div>`;
      } else {
        exclusionsHtml += `<div class="exclusion-item">${exclusion}</div>`;
      }
    }
    exclusionsHtml += "</div>";
    // Add frailty dot phrase if needed

  } else {
    exclusionsHtml = "<p>No exclusions specified for this measure.</p>";
  }
  dropdown.innerHTML = exclusionsHtml;
}
// Display guideline details
function displayGuideline(measureID, subtype, type, points) {
  const guidelines = medicalData.conditions;
  let found = null;
  // Loop through all guidelines
  for (const key in guidelines) {
    if (guidelines.hasOwnProperty(key)) {
      const guideline = guidelines[key];
      if (guideline.measure_id === measureID) {
        // For duplicate measure IDs, check type if provided
        if (measureID === "TRC" && type) {
          if (type === "Reconciliation" && guideline.description.includes("medication reconciliation")) {
            found = { title: key, ...guideline };
            break;
          }
          if (type === "Engagement" && guideline.description.includes("patient engagement")) {
            found = { title: key, ...guideline };
            break;
          }
        } else if (measureID === "TRC-FU" && key.includes("7-Day Follow-Up")) {
          found = { title: key, ...guideline };
          break;
        } else {
          found = { title: key, ...guideline };
          break;
        }
      }
    }
  }
  // Now assign found to currentGuideline
  currentGuideline = found;
  const detailsDiv = document.getElementById("guidelineDetails");
  const extraDiv = document.getElementById("extraDetails");
  // Reset star ratings and bonus tiers divs to hidden when a new measure is selected
  document.getElementById("starRatingsDetails").style.display = "none";
  document.getElementById("toggleStarRatingsBtn").innerText = "Show Star Ratings";
  // Reset exclusions dropdown
document.getElementById("exclusionsDropdown").style.display = "none";
document.getElementById("exclusionsBtn").textContent = "See Exclusions";
  document.getElementById("bonusTiersDetails").style.display = "none";
  document.getElementById("toggleBonusTiersBtn").innerText = "Show Bonus Tiers";
  // Show or hide the bonus tiers button based on whether the measure is a bonus measure
  const bonusTiersBtn = document.getElementById("toggleBonusTiersBtn");
  if (found && isBonusMeasure(measureID)) {
    bonusTiersBtn.style.display = "inline-block";
    console.log("Showing bonus tiers button for measure:", measureID);
  } else {
    bonusTiersBtn.style.display = "none";
    console.log("Hiding bonus tiers button for measure:", measureID);
  }
  if (found) {
    // Handle description array - display each item as a separate paragraph
    let descriptionHtml = "";
    if (Array.isArray(found.description)) {
      descriptionHtml = found.description.map(desc => `<p>${desc}</p>`).join('');
    } else {
      descriptionHtml = found.description;
    }
    // Create PDF link if available
    let pdfLinkHtml = "";
    if (found.link) {
      pdfLinkHtml = `<a href="${found.link}" target="_blank" style="margin-left: 10px; color: #007bff;"><br>Link to Shared Savings Section</a>`;
    }
    detailsDiv.innerHTML = `
      <ul>
        <li><strong>Title:</strong> ${found.title}</li>
        <li><strong>Measure ID:</strong> ${found.measure_id} ${pdfLinkHtml}</li>
        <li><strong>Description:</strong> <div>${descriptionHtml}</div></li>
        <li><strong>Measurement Period:</strong> ${found.measurement_period}</li>
        <li><strong>Ages:</strong> ${found.ages}</li>
      </ul>
    `;
    // Build exclusions HTML as a list
    let exclusionsHtml = "";
    if (found.denominator_exclusions && found.denominator_exclusions.length > 0) {
      exclusionsHtml = `<ul>${found.denominator_exclusions.map(exclusion => `<li>${exclusion}</li>`).join('')}</ul>`;
    } else {
      exclusionsHtml = "None";
    }
    // Build gap closure methods as a list
    let gapMethodsHtml = "";
    if (found.methods_to_close_gap && found.methods_to_close_gap.length > 0) {
      gapMethodsHtml = `<ul>${found.methods_to_close_gap.map(method => `<li>${method}</li>`).join('')}</ul>`;
    } else {
      gapMethodsHtml = "No gap closure methods specified";
    }
    // Build best practices HTML
    let practicesHtml = "";
    if (found.best_practices && found.best_practices.length > 0) {
      practicesHtml = `<ul>${found.best_practices.map(practice => `<li>${practice}</li>`).join('')}</ul>`;
    } else {
      practicesHtml = "None specified";
    }
    extraDiv.innerHTML = `
  <ul>
    <li><strong>Best Practices:</strong> ${practicesHtml}</li>
    <li><strong>Epic Dot Phrase:</strong> <code>.${measureID.toLowerCase()}patientinfo</code> - Patient info for this measure</li>
  </ul>
`;
// Find the button text for this measure
let buttonText = "";
document.querySelectorAll(`button[data-measure="${measureID}"]`).forEach(btn => {
  // Prefer the text from the main grid, not the focus measures section
  if (!btn.className.includes('focus-')) {
    buttonText = btn.textContent.trim();
  }
});
if (!buttonText) {
  // If we didn't find it in the main grid, check the focus measures
  document.querySelectorAll(`button[data-measure="${measureID}"]`).forEach(btn => {
    buttonText = btn.textContent.trim();
  });
}
// Display gap closure information as a list with the button text
document.getElementById("gapText").innerHTML = `<strong>${buttonText}</strong> ${gapMethodsHtml}`;
    // Populate the exclusions dropdown
populateExclusions(found);
// Display weight information
const weightText = document.getElementById("weightText");
if (points === 3) {
  weightText.innerHTML = `<strong>HIGH PRIORITY MEASURE (×3)</strong> - This measure is weighted TRIPLE!`;
} else if (points === 2) {
  weightText.innerHTML = `<strong>MEDIUM PRIORITY MEASURE (×2)</strong> - This measure is weighted DOUBLE!`;
} else {
  weightText.innerHTML = `<strong>STANDARD MEASURE (×1)</strong> - This measure is weighted one`;
}
    // Show the details box
    document.getElementById("details").style.display = "block";
  } else {
    // No details found
    detailsDiv.innerHTML = `<p>No details found for measure ${measureID}.</p>`;
    extraDiv.innerHTML = "";
    document.getElementById("details").style.display = "block";
  }
  // Clear previous active button state
  clearActiveButtonState();
  // Set active state on matching buttons
  document.querySelectorAll(`button[data-measure="${measureID}"]`).forEach(btn => {
    btn.classList.add('active-measure');
  });
}
// Document ready function
document.addEventListener('DOMContentLoaded', function() {
  // Add event listeners for plan toggle buttons
  document.getElementById("commercial-btn").addEventListener("click", function() {
    switchPlan("commercial");
  });
  document.getElementById("medicaid-btn").addEventListener("click", function() {
    switchPlan("medicaid");
  });
  document.getElementById("medicare-btn").addEventListener("click", function() {
    switchPlan("medicare");
  });
  // Add event listener for exclusions button
document.getElementById("exclusionsBtn").addEventListener("click", function() {
  const dropdown = document.getElementById("exclusionsDropdown");
  if (dropdown.style.display === "none" || dropdown.style.display === "") {
    dropdown.style.display = "block";
    this.textContent = "Hide Exclusions";
  } else {
    dropdown.style.display = "none";
    this.textContent = "See Exclusions";
  }
});
// Toggle best practices
document.getElementById("toggleExtraBtn").addEventListener("click", function() {
  const extraDiv = document.getElementById("extraDetails");
  if (extraDiv.style.display === "none" || extraDiv.style.display === "") {
    extraDiv.style.display = "block";
    this.innerText = "Hide Best Practices";
  } else {
    extraDiv.style.display = "none";
    this.innerText = "Best Practices";
  }
});
// Add event listener for toggle star ratings button
document.getElementById("toggleStarRatingsBtn").addEventListener("click", function() {
  const starRatingsDiv = document.getElementById("starRatingsDetails");
  if (starRatingsDiv.style.display === "none" || starRatingsDiv.style.display === "") {
    starRatingsDiv.style.display = "block";
    this.innerText = "Hide Star Ratings";
    // Call displayStarRatings with current measure if available
    if (currentGuideline && typeof displayStarRatings === "function") {
      console.log("Calling displayStarRatings with:", currentGuideline.measure_id);
      displayStarRatings(currentGuideline.measure_id);
    } else {
      console.log("Cannot display star ratings - currentGuideline or function missing");
      document.getElementById("starRatingsContent").innerHTML = "<p>Star ratings information not available for this measure.</p>";
    }
  } else {
    starRatingsDiv.style.display = "none";
    this.innerText = "Show Star Ratings";
  }
});
  // Add event listener for toggle bonus tiers button
  document.getElementById("toggleBonusTiersBtn").addEventListener("click", function() {
    const bonusTiersDiv = document.getElementById("bonusTiersDetails");
    if (bonusTiersDiv.style.display === "none" || bonusTiersDiv.style.display === "") {
      bonusTiersDiv.style.display = "block";
      this.innerText = "Hide Bonus Tiers";
      // Display bonus tiers for current measure if available
      if (currentGuideline) {
        displayBonusTiers(currentGuideline.measure_id);
      }
    } else {
      bonusTiersDiv.style.display = "none";
      this.innerText = "Show Bonus Tiers";
    }
  });
  // Close details button
  document.getElementById("closeDetailsBtn").addEventListener("click", function() {
    document.getElementById("details").style.display = "none";
    currentGuideline = null;
    // Clear active button state when closing details
    clearActiveButtonState();
  });
  // Ask AI Section: Build and display a prompt based on the current guideline
  document.getElementById("askAIBtn").addEventListener("click", function() {
    if (!currentGuideline) {
      alert("Please select a measure first.");
      return;
    }
    // Format exclusions for AI prompt - join with "or" instead of using bullet points
    const exclusions = currentGuideline.denominator_exclusions && currentGuideline.denominator_exclusions.length > 0
      ? currentGuideline.denominator_exclusions.map(code => code.trim()).join(' or ')
      : "None specified";
      // In the Ask AI button click handler
const points = planData[currentPlan].measurePoints[currentGuideline.measure_id] || 1;
let weightInfo = points === 3
  ? "This is a HIGH PRIORITY (×3) measure weighted TRIPLE."
  : points === 2
  ? "This is a MEDIUM PRIORITY (×2) measure weighted DOUBLE."
  : "This is a STANDARD (×1) measure weighted one.";
    const prompt = `Dear AI, please consider this healthcare measure:
Measure ID: ${currentGuideline.measure_id}
Description: ${Array.isArray(currentGuideline.description) ? currentGuideline.description.join('\n') : currentGuideline.description}
Priority Weight: ${points} (${weightInfo})
Please find the diagnosis codes for the exclusions and give them as numbers separated by "or" so that I can put them into a search bar. The exclusions are: ${exclusions}
Please provide any additional important insights you may have afterward.`;
    const txtArea = document.getElementById("exhaustiveQuery");
    txtArea.value = prompt;
    txtArea.style.display = "block";
    document.getElementById("copyQueryBtn").style.display = "block";
  });
  // Copy the prompt to the clipboard
  document.getElementById("copyQueryBtn").addEventListener("click", function() {
    const txtArea = document.getElementById("exhaustiveQuery");
    txtArea.select();
    document.execCommand("copy");
    alert("Exclusion diagnosis prompt copied to clipboard!");
  });
  // Load data and initialize
  // First, load the rules8.json file
  fetch('rules8.json')
    .then(response => {
      if (!response.ok) throw new Error("Error loading JSON: " + response.statusText);
      return response.json();
    })
    .then(data => {
      medicalData = data;
      console.log("Loaded rules8.json:", medicalData);
      // Then load star ratings data
      loadStarRatings();
      // Load bonus measures data
      loadBonusMeasures();
      // Initialize with Medicare plan instead of Commercial
      switchPlan("medicare");
    })
    .catch(error => {
      console.error("Error loading data:", error);
      alert("Error loading data file. Please ensure rules8.json is available.");
      generateFocusMeasures("medicare");
      generateButtons("medicare");
    });
});
<!-- 1552000 -->
  </script>
<!-- 1553000 -->
</body>
<!-- 1554000 -->
</html>
